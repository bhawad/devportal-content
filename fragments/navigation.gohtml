<nav class="o-page__nav c-nav">
  {{$haveApi := false}}
  {{$haveOther := false}}
  {{$docBasePath := printf "%sdoc/" $.Prefix }}
  {{ if $.S.DocsBasePath }}
  {{$docBasePath = printf "%s%s" $.Prefix $.S.DocsBasePath }}
  {{ end }}
  {{range $i, $element := .S.K8sStore.Slice }}
    {{if $element.Metadata.HasDoc}}
      {{$haveApi = true}}
    {{else}}
      {{$haveOther = true}}
    {{end}}
  {{end}}
    <div>
        <strong>APIs</strong>
        <ul>
        {{range $i, $element := .S.K8sStore.Slice }}
            {{$svc := $element.Service}}
            {{$class := ""}}
            {{if and (eq $.CurrentService $svc.Name) (eq $.CurrentNamespace $svc.Namespace)}}
                {{$class = "c-nav__selected"}}
            {{end}}
            {{if $element.Metadata.HasDoc}}
            <li>
                {{ if $element.Metadata.DevportalPath }}
                <a class="{{$class}}" href="{{$docBasePath}}{{$element.Metadata.DevportalPath}}">
                {{ else }}
                <a class="{{$class}}" href="{{$docBasePath}}{{$svc.Namespace}}/{{$svc.Name}}">
                {{ end  }}
                {{ if $element.Metadata.ServiceDisplayName }}
                    {{ $element.Metadata.ServiceDisplayName }}
                {{ else }}
                    {{$svc.Namespace}}.{{$svc.Name}}
                {{ end }}
                </a>
            </li>
            {{end}}
        {{end}}
        {{if not $haveApi}}
        <li><samp>None</samp></li>
        {{end}}
        </ul>
    </div>
    <br />
    <div>
        <strong>Reference</strong>
        <ul>
            {{range $i, $page := $.Pages}}
                {{$class := ""}}
                {{if eq $.CurrentPage $page}}
                    {{$class = "c-nav__selected"}}
                {{end}}
                <li><a class="{{$class}}" href="{{$.Prefix}}page/{{$page}}">{{$page}}</a></li>
            {{end}}
        </ul>
    </div>
    {{if $haveOther}}
    <br />
    <div>
        <strong>Services without documentation</strong>
        <ul>
        {{range $i, $element := .S.K8sStore.Slice }}
            {{$svc := $element.Service}}
            {{if not $element.Metadata.HasDoc}}
            <li>
                <samp>{{$svc.Namespace}}.{{$svc.Name}}</samp>
            </li>
            {{end}}
        {{end}}
        </ul>
    </div>
    {{end}}
</nav>
